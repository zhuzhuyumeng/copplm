
ood数据集处理
··· https://deepwiki.com/zyang1580/BinLLM/4.2-movielens-dataset
!已处理
set CUDA_VISIBLE_DEVICES=0
python baseline_train_mf_ood.py

python train_collm_mf_din.py --cfg-path=train_configs/evaluate/1027_evaluate_LoRA-collm-qwen-ml.yaml
CUDA_VISIBLE_DEVICES=0 WORLD_SIZE=2 nohup torchrun --nproc-per-node 2 --master_port=11139 train_collm_mf_din.py  --cfg-path=train_configs/collm_pretrain_mf_ood.yaml > /log.out &

转换后的vicuna要独立

python train_collm_mf_din.py --cfg-path=train_configs/evaluate/article_evalutae_collm_pretrain_mf_ood.yaml > log/article_evaluate_log.txt 2>&1 # no problem


python train_collm_mf_din.py --cfg-path=train_configs/0924-tallrec-qwen-ml.yaml
python train_collm_mf_din.py --cfg-path=train_configs/0924-collm-qwen-ml.yaml


python train_collm_mf_din.py --cfg-path=train_configs/0924-tallrec-qwen-book.yaml

评估，第一个是tallrec的结果，第二个是collm的结果
ckpt: minigpt4/Qwen/Qwen2.5-1.5rec_log/20251026143/checkpoint_best.pth # stage1 model/ tallrec
resume_ckpt_path: minigpt4/Qwen/Qwen2.5-1.5rec_log/collm/20251026193/checkpoint_best.pth #/data/fengfl/collm/20241021210/checkpoint_best.pth
2025-10-27 07:30:43,584 [INFO] Averaged stats: loss: 0.670087  acc: 0.402946 ***auc: 0.6707200734079944 ***uauc:(0.5729391208783384, [6, 40, 47, 83, 92, 143, 182, 183, 193, 273, 277, 313, 319, 345, 354, 358, 362, 371, 403, 404, 427, 454, 468, 490, 517, 538, 553, 562, 585, 588, 607, 629, 635, 646, 648, 651, 679, 680, 703, 709, 710, 731, 732, 735, 736, 747, 773, 796, 800, 802, 821], array([0.62489557, 0.54571429, 0.7037594 , 0.5       , 0.96341463,
       0.5       , 0.        , 0.69610997, 0.875     , 0.        ,
       0.62735043, 0.64430894, 0.57120743, 0.58035714, 0.26666667,
       0.5       , 0.48039216, 0.75      , 0.60291935, 0.51388889,
       0.65625   , 0.54987923, 0.55671078, 0.33333333, 0.91666667,
       0.76519916, 1.        , 1.        , 0.55555556, 0.52222222,
       0.        , 0.6       , 0.        , 0.57575758, 0.71366013,
       0.57142857, 0.64169699, 0.65833333, 0.70833333, 0.7       ,
       0.33333333, 0.66112957, 0.71969697, 0.6       , 0.77018634,
       0.58333333, 0.25      , 0.5       , 0.5       , 0.72380952,
       0.60739437]))
rank_0 auc: 0.6707200734079944
2025-10-27 07:30:43,584 [INFO] Training time 0:11:22

第二次评估
ckpt: minigpt4/Qwen/Qwen2.5-1.5rec_log/collm/20251026193/checkpoint_best.pth  # stage1 model/ tallrec
resume_ckpt_path: minigpt4/Qwen/Qwen2.5-1.5rec_log/collm/20251026193/checkpoint_best.pth #/data/fengfl/collm/20241021210/checkpoint_best.pth
2025-10-27 08:34:31,070 [INFO] Averaged stats: loss: 5.340047  acc: 0.570789 ***auc: 0.4736689242858788 ***uauc:(0.5092304334987883, [6, 40, 47, 83, 92, 143, 182, 183, 193, 273, 277, 313, 319, 345, 354, 358, 362, 371, 403, 404, 427, 454, 468, 490, 517, 538, 553, 562, 585, 588, 607, 629, 635, 646, 648, 651, 679, 680, 703, 709, 710, 731, 732, 735, 736, 747, 773, 796, 800, 802, 821], array([0.45781119, 0.45333333, 0.5887218 , 0.5       , 0.45121951,
       0.        , 0.5       , 0.50660093, 1.        , 0.5       ,
       0.54814815, 0.42479675, 0.5878483 , 0.37946429, 0.46666667,
       0.3875    , 0.44117647, 0.62083333, 0.48565067, 0.54166667,
       0.51194853, 0.46243961, 0.48251418, 0.66666667, 0.33333333,
       0.4591195 , 1.        , 0.        , 0.4382716 , 0.42222222,
       0.        , 1.        , 1.        , 0.59090909, 0.4469281 ,
       0.35714286, 0.56847713, 0.51597222, 0.41666667, 0.57083333,
       0.76086957, 0.26079734, 0.49356061, 0.4       , 0.45186335,
       0.77777778, 0.75      , 0.75      , 0.47869318, 0.27619048,
       0.4861167 ]))
rank_0 auc: 0.4736689242858788
2025-10-27 08:34:31,072 [INFO] Training time 0:11:45


python train_collm_mf_din.py --cfg-path=train_configs/aritic_collm_pretrain_mf_ood.yaml


作者源文件
    pretrained_path: collm-trained-models/0912_ml1m_oodv2_best_model_d256lr-0.001wd0.0001.pth # pretrained rec model
  ckpt: collm-trained-models/collm-mf-ml-best.pth # used for CIE tuning or evaluation

2025-10-27 09:22:58,129 [INFO] Averaged stats: loss: 6.878286  acc: 0.530297 ***auc: 0.5202658047054376 ***uauc:(0.5401093157615947, [20, 26, 33, 36, 37, 39, 40, 41, 49, 57, 72, 73, 79, 83, 85, 87, 93, 95, 104, 107, 108, 109, 110, 112, 119, 121
, 124, 139, 142, 145, 147, 149, 153, 155, 159, 164, 165, 170, 171, 173, 174, 175, 177, 178, 180, 185, 186, 193, 197, 200, 204, 205, 207, 208, 210, 212, 214, 215, 221, 222, 226, 227, 228, 230, 231, 237, 242, 246, 247, 249, 250, 255, 260, 261, 26
4, 271, 273, 275, 277, 279, 282, 286, 291, 292, 296, 297, 298, 300, 304, 308, 309, 312, 314, 325, 327, 329, 336, 338, 340, 341, 345, 346, 350, 353, 356, 364, 367, 368, 370, 377, 381, 382, 384, 389, 402, 415, 426, 427, 428, 433, 434, 436, 441, 4
44, 446, 449, 451, 453, 458, 462, 466, 470, 472, 474, 475, 482, 484, 490, 494, 496, 498, 500, 512, 516, 521, 522, 529, 530, 531, 550, 558, 561, 562, 563, 566, 568, 569, 575, 576, 577, 581, 583, 598, 604, 607, 608, 609, 613, 617, 624, 626, 627,
628, 629, 630, 632, 633, 643, 645, 649, 650, 658, 664, 665, 669, 670, 671, 672, 676, 686, 690, 695, 696, 697, 698, 699, 700, 701, 702, 706, 707, 709, 712, 714, 718, 720, 725, 727, 728, 733, 748, 752, 753, 758, 760, 761, 762, 767, 769, 772, 773, 774, 779, 784, 786, 788, 789, 793, 795, 797, 798, 799, 802, 803, 804, 809, 814, 818, 833], array([1.        , 0.46428571, 1.        , 0.61217949, 1.        ,
       0.        , 0.51020408, 0.56521739, 0.82142857, 0.375     ,
       0.5625    , 0.31722689, 0.55555556, 0.60017361, 0.25      ,
       0.69717262, 0.66666667, 0.41666667, 0.6       , 0.70526316,
       0.54444444, 0.        , 0.36666667, 1.        , 0.5       ,
       0.60921717, 0.30952381, 0.8       , 0.3125    , 0.26666667,
       0.54166667, 0.83333333, 0.        , 0.71875   , 0.5       ,
       0.51149425, 0.75      , 0.45644599, 0.65277778, 1.        ,
       0.75      , 0.33333333, 0.43461538, 0.5       , 0.4       ,
       0.25      , 1.        , 0.53125   , 0.        , 0.25      ,
       1.        , 0.68154762, 0.66666667, 0.48765432, 0.9       ,
       0.66666667, 0.75      , 0.23214286, 0.69444444, 0.26530612,
       0.75      , 0.7       , 0.59666667, 0.54192547, 0.56181319,
       0.5       , 0.25      , 0.33333333, 0.5       , 0.33695652,
       0.34848485, 0.66666667, 0.        , 0.61426979, 0.49117647,
       0.1875    , 0.625     , 0.53684211, 0.53074534, 0.08333333,
       0.55555556, 0.90555556, 0.78571429, 0.30202822, 0.67013889,
       0.54411765, 0.5078125 , 0.55392157, 0.51315789, 0.84705882,
       0.46218487, 0.74603175, 0.7       , 0.625     , 0.5       ,
       0.39583333, 1.        , 0.1       , 0.33333333, 0.25      ,
       0.77777778, 0.5       , 0.52380952, 0.66666667, 0.75      ,
       0.53649237, 0.359375  , 0.5       , 0.3       , 0.        ,
       0.36      , 0.87962963, 0.33333333, 0.50509338, 0.46666667,
       0.        , 0.66666667, 0.33333333, 1.        , 0.6       ,
       0.42873793, 0.52380952, 0.55980392, 0.        , 0.65087719,
       0.76785714, 0.66666667, 0.16666667, 0.57819795, 0.44565217,
       1.        , 0.39583333, 0.66666667, 0.8       , 0.63541667,
       1.        , 0.5       , 0.        , 0.84210526, 0.        ,
       0.14285714, 0.        , 0.625     , 0.63020833, 0.5       ,
       0.48979592, 0.8       , 0.44444444, 0.40374332, 0.33333333,
       0.59722222, 1.        , 0.5       , 0.26666667, 0.        ,
       0.52564103, 0.42      , 0.5625    , 0.33333333, 0.        ,
       1.        , 0.33333333, 0.875     , 0.        , 0.60784314,
       0.48290598, 0.73214286, 0.35714286, 0.33333333, 0.56666667,
       0.625     , 0.56060606, 0.72222222, 0.49091253, 0.16363636,
       0.59259259, 0.75      , 0.52515036, 0.5       , 0.375     ,
       1.        , 0.43055556, 0.25      , 0.85      , 0.72      ,
       1.        , 0.5       , 0.63636364, 1.        , 0.554     ,
       0.        , 0.33333333, 0.33333333, 0.77777778, 0.51283213,
       0.36      , 0.47807018, 0.60462185, 0.46428571, 0.80882353,
       0.83333333, 0.66666667, 1.        , 1.        , 0.28846154,
       0.5       , 1.        , 0.33333333, 0.75      , 0.25      ,
       1.        , 0.5       , 0.        , 0.        , 0.        ,
       0.38846154, 0.66326531, 0.66666667, 0.325     , 1.        ,
       0.47222222, 0.66666667, 1.        , 0.        , 0.78205128,
       0.65277778, 0.5       , 0.48717949, 1.        , 0.46969697,
       0.8       , 0.80672269, 0.23333333, 0.70549242]))
rank_0 auc: 0.5202658047054376
2025-10-27 09:22:58,129 [INFO] Training time 0:20:32
效果好差啊。为什么捏‘

没变
    pretrained_path: collm-trained-models/0912_ml1m_oodv2_best_model_d256lr-0.001wd0.0001.pth # pretrained rec model
  ckpt: collm-trained-models/tallrec_ml_best.pth # used for CIE tuning or evaluation

2025-10-27 09:59:50,972 [INFO] Averaged stats: loss: 6.878286  acc: 0.530297 ***auc: 0.5202658047054376 ***uauc:(0.5401093157615947, [20, 26, 33, 36, 37, 39, 40, 41, 49, 57, 72, 73, 79, 83, 85, 87, 93, 95, 104, 107, 108, 109, 110, 112, 119, 121
, 124, 139, 142, 145, 147, 149, 153, 155, 159, 164, 165, 170, 171, 173, 174, 175, 177, 178, 180, 185, 186, 193, 197, 200, 204, 205, 207, 208, 210, 212, 214, 215, 221, 222, 226, 227, 228, 230, 231, 237, 242, 246, 247, 249, 250, 255, 260, 261, 26
4, 271, 273, 275, 277, 279, 282, 286, 291, 292, 296, 297, 298, 300, 304, 308, 309, 312, 314, 325, 327, 329, 336, 338, 340, 341, 345, 346, 350, 353, 356, 364, 367, 368, 370, 377, 381, 382, 384, 389, 402, 415, 426, 427, 428, 433, 434, 436, 441, 4
44, 446, 449, 451, 453, 458, 462, 466, 470, 472, 474, 475, 482, 484, 490, 494, 496, 498, 500, 512, 516, 521, 522, 529, 530, 531, 550, 558, 561, 562, 563, 566, 568, 569, 575, 576, 577, 581, 583, 598, 604, 607, 608, 609, 613, 617, 624, 626, 627,
628, 629, 630, 632, 633, 643, 645, 649, 650, 658, 664, 665, 669, 670, 671, 672, 676, 686, 690, 695, 696, 697, 698, 699, 700, 701, 702, 706, 707, 709, 712, 714, 718, 720, 725, 727, 728, 733, 748, 752, 753, 758, 760, 761, 762, 767, 769, 772, 773, 774, 779, 784, 786, 788, 789, 793, 795, 797, 798, 799, 802, 803, 804, 809, 814, 818, 833], array([1.        , 0.46428571, 1.        , 0.61217949, 1.        ,
       0.        , 0.51020408, 0.56521739, 0.82142857, 0.375     ,
       0.5625    , 0.31722689, 0.55555556, 0.60017361, 0.25      ,
       0.69717262, 0.66666667, 0.41666667, 0.6       , 0.70526316,
       0.54444444, 0.        , 0.36666667, 1.        , 0.5       ,
       0.60921717, 0.30952381, 0.8       , 0.3125    , 0.26666667,
       0.54166667, 0.83333333, 0.        , 0.71875   , 0.5       ,
       0.51149425, 0.75      , 0.45644599, 0.65277778, 1.        ,
       0.75      , 0.33333333, 0.43461538, 0.5       , 0.4       ,
       0.25      , 1.        , 0.53125   , 0.        , 0.25      ,
       1.        , 0.68154762, 0.66666667, 0.48765432, 0.9       ,
       0.66666667, 0.75      , 0.23214286, 0.69444444, 0.26530612,
       0.75      , 0.7       , 0.59666667, 0.54192547, 0.56181319,
       0.5       , 0.25      , 0.33333333, 0.5       , 0.33695652,
       0.34848485, 0.66666667, 0.        , 0.61426979, 0.49117647,
       0.1875    , 0.625     , 0.53684211, 0.53074534, 0.08333333,
       0.55555556, 0.90555556, 0.78571429, 0.30202822, 0.67013889,
       0.54411765, 0.5078125 , 0.55392157, 0.51315789, 0.84705882,
       0.46218487, 0.74603175, 0.7       , 0.625     , 0.5       ,
       0.39583333, 1.        , 0.1       , 0.33333333, 0.25      ,
       0.77777778, 0.5       , 0.52380952, 0.66666667, 0.75      ,
       0.53649237, 0.359375  , 0.5       , 0.3       , 0.        ,
       0.36      , 0.87962963, 0.33333333, 0.50509338, 0.46666667,
       0.        , 0.66666667, 0.33333333, 1.        , 0.6       ,
       0.42873793, 0.52380952, 0.55980392, 0.        , 0.65087719,
       0.76785714, 0.66666667, 0.16666667, 0.57819795, 0.44565217,
       1.        , 0.39583333, 0.66666667, 0.8       , 0.63541667,
       1.        , 0.5       , 0.        , 0.84210526, 0.        ,
       0.14285714, 0.        , 0.625     , 0.63020833, 0.5       ,
       0.48979592, 0.8       , 0.44444444, 0.40374332, 0.33333333,
       0.59722222, 1.        , 0.5       , 0.26666667, 0.        ,
       0.52564103, 0.42      , 0.5625    , 0.33333333, 0.        ,
       1.        , 0.33333333, 0.875     , 0.        , 0.60784314,
       0.48290598, 0.73214286, 0.35714286, 0.33333333, 0.56666667,
       0.625     , 0.56060606, 0.72222222, 0.49091253, 0.16363636,
       0.59259259, 0.75      , 0.52515036, 0.5       , 0.375     ,
       1.        , 0.83333333, 1.        , 0.75555556, 0.64772727,
       1.        , 0.43055556, 0.25      , 0.85      , 0.72      ,
       1.        , 0.5       , 0.63636364, 1.        , 0.554     ,
       0.        , 0.33333333, 0.33333333, 0.77777778, 0.51283213,
       0.36      , 0.47807018, 0.60462185, 0.46428571, 0.80882353,
       0.83333333, 0.66666667, 1.        , 1.        , 0.28846154,
       0.5       , 1.        , 0.33333333, 0.75      , 0.25      ,
       1.        , 0.5       , 0.        , 0.        , 0.        ,
       0.38846154, 0.66326531, 0.66666667, 0.325     , 1.        ,
       0.47222222, 0.66666667, 1.        , 0.        , 0.78205128,
       0.65277778, 0.5       , 0.48717949, 1.        , 0.46969697,
       0.8       , 0.80672269, 0.23333333, 0.70549242]))
rank_0 auc: 0.5202658047054376
2025-10-27 09:59:50,975 [INFO] Training time 0:18:15

修改prompt是否对上次结果有影响？上次是tallrec_prompt，这次是tallrec。真有影响啊
    pretrained_path: collm-trained-models/0912_ml1m_oodv2_best_model_d256lr-0.001wd0.0001.pth # pretrained rec model
  ckpt: collm-trained-models/tallrec_ml_best.pth # used for CIE tuning or evaluation
2025-10-27 11:06:48,405 [INFO] Averaged stats: loss: 5.869035  acc: 0.530297 ***auc: 0.5225780021408466 ***uauc:(0.5199439321279022, [20, 26, 33, 36, 37, 39, 40, 41, 49, 57, 72, 73, 79, 83, 85, 87, 93, 95, 104, 107, 108, 109, 110, 112, 119, 121
, 124, 139, 142, 145, 147, 149, 153, 155, 159, 164, 165, 170, 171, 173, 174, 175, 177, 178, 180, 185, 186, 193, 197, 200, 204, 205, 207, 208, 210, 212, 214, 215, 221, 222, 226, 227, 228, 230, 231, 237, 242, 246, 247, 249, 250, 255, 260, 261, 26
4, 271, 273, 275, 277, 279, 282, 286, 291, 292, 296, 297, 298, 300, 304, 308, 309, 312, 314, 325, 327, 329, 336, 338, 340, 341, 345, 346, 350, 353, 356, 364, 367, 368, 370, 377, 381, 382, 384, 389, 402, 415, 426, 427, 428, 433, 434, 436, 441, 4
44, 446, 449, 451, 453, 458, 462, 466, 470, 472, 474, 475, 482, 484, 490, 494, 496, 498, 500, 512, 516, 521, 522, 529, 530, 531, 550, 558, 561, 562, 563, 566, 568, 569, 575, 576, 577, 581, 583, 598, 604, 607, 608, 609, 613, 617, 624, 626, 627,
628, 629, 630, 632, 633, 643, 645, 649, 650, 658, 664, 665, 669, 670, 671, 672, 676, 686, 690, 695, 696, 697, 698, 699, 700, 701, 702, 706, 707, 709, 712, 714, 718, 720, 725, 727, 728, 733, 748, 752, 753, 758, 760, 761, 762, 767, 769, 772, 773, 774, 779, 784, 786, 788, 789, 793, 795, 797, 798, 799, 802, 803, 804, 809, 814, 818, 833], array([1.        , 0.27678571, 1.        , 0.52564103, 0.83333333,
       0.6       , 0.40816327, 0.54782609, 0.52380952, 0.75      ,
       0.58333333, 0.3907563 , 0.74603175, 0.56145833, 0.6875    ,
       0.59747024, 1.        , 0.66666667, 0.57777778, 0.51578947,
       0.53194444, 0.        , 0.56666667, 1.        , 0.        ,
       0.49368687, 0.30952381, 0.66666667, 0.6875    , 0.06666667,
       0.90277778, 0.58333333, 0.        , 0.703125  , 0.5       ,
       0.66060026, 0.57539683, 0.49216028, 0.82638889, 1.        ,
       0.625     , 0.        , 0.51576923, 0.5       , 0.5       ,
       0.25      , 0.        , 0.57638889, 0.5       , 0.5       ,
       1.        , 0.73214286, 0.41666667, 0.62037037, 0.65      ,
       0.5       , 0.625     , 0.17857143, 0.75      , 0.36479592,
       0.78571429, 0.7       , 0.68916667, 0.65838509, 0.48214286,
       0.        , 0.5       , 0.66666667, 0.5       , 0.34130435,
       0.58333333, 1.        , 0.        , 0.42502787, 0.57058824,
       0.5       , 0.78075397, 0.61315789, 0.64409938, 0.1875    ,
       0.94444444, 0.49259259, 0.5       , 0.44223986, 0.77083333,
       0.58660131, 0.51432292, 0.41666667, 0.28070175, 0.82352941,
       0.57983193, 0.36507937, 0.7       , 1.        , 0.        ,
       0.52083333, 1.        , 0.6       , 0.        , 0.5       ,
       0.84722222, 0.5       , 0.61904762, 0.        , 0.5       ,
       0.51633987, 0.5078125 , 0.33333333, 0.35      , 0.        ,
       0.7       , 0.77777778, 0.        , 0.48387097, 0.73333333,
       0.5       , 0.45833333, 0.33333333, 0.        , 0.66666667,
       0.49234099, 0.42857143, 0.62156863, 0.        , 0.60175439,
       0.32142857, 0.83333333, 0.83333333, 0.55742297, 0.35869565,
       0.        , 0.4375    , 0.33333333, 0.6       , 0.38888889,
       0.5       , 0.        , 0.5       , 0.61578947, 0.        ,
       0.57142857, 0.        , 0.625     , 0.46701389, 0.        ,
       0.36734694, 0.9       , 0.44444444, 0.5855615 , 0.33333333,
       0.43055556, 1.        , 0.75      , 0.34444444, 1.        ,
       0.45726496, 0.47190476, 0.3125    , 0.16666667, 0.33333333,
       0.5       , 0.29166667, 0.5       , 0.        , 0.68431373,
       0.4981685 , 0.48214286, 0.4702381 , 0.22222222, 0.63333333,
       0.55147059, 0.53535354, 0.77777778, 0.47513568, 0.47272727,
       0.55555556, 0.25      , 0.51312192, 0.5       , 1.        ,
       1.        , 0.33333333, 1.        , 0.64444444, 0.59090909,
       0.5       , 0.23611111, 0.        , 0.5       , 0.72      ,
       0.        , 0.5       , 0.72727273, 1.        , 0.608     ,
       0.66666667, 0.66666667, 1.        , 0.77777778, 0.5326087 ,
       0.24      , 0.52046784, 0.48655462, 0.28571429, 0.35294118,
       0.45833333, 0.61111111, 0.75      , 0.33333333, 0.26923077,
       0.        , 1.        , 0.4       , 0.28125   , 0.75      ,
       0.        , 0.58571429, 0.        , 1.        , 1.        ,
       0.51538462, 0.45918367, 0.66666667, 0.525     , 1.        ,
       0.33333333, 0.33333333, 0.42857143, 1.        , 0.57692308,
       0.63888889, 0.66666667, 0.59672184, 0.66666667, 0.50757576,
       0.93333333, 0.75630252, 0.2       , 0.57954545]))
rank_0 auc: 0.5225780021408466
2025-10-27 11:06:48,406 [INFO] Training time 0:55:58

重跑上面一遍，观察结果,此为collm结果
2025-10-27 14:59:27,940 [INFO] Averaged stats: loss: 5.869035  acc: 0.530297 ***auc: 0.5225780021408466 ***uauc:(0.5199439321279022, [20, 26, 33, 36, 37, 39, 40, 41, 49, 57, 72, 73, 79, 83, 85, 87, 93, 95, 104, 107, 108, 109, 110, 112, 119, 121
, 124, 139, 142, 145, 147, 149, 153, 155, 159, 164, 165, 170, 171, 173, 174, 175, 177, 178, 180, 185, 186, 193, 197, 200, 204, 205, 207, 208, 210, 212, 214, 215, 221, 222, 226, 227, 228, 230, 231, 237, 242, 246, 247, 249, 250, 255, 260, 261, 26
4, 271, 273, 275, 277, 279, 282, 286, 291, 292, 296, 297, 298, 300, 304, 308, 309, 312, 314, 325, 327, 329, 336, 338, 340, 341, 345, 346, 350, 353, 356, 364, 367, 368, 370, 377, 381, 382, 384, 389, 402, 415, 426, 427, 428, 433, 434, 436, 441, 4
44, 446, 449, 451, 453, 458, 462, 466, 470, 472, 474, 475, 482, 484, 490, 494, 496, 498, 500, 512, 516, 521, 522, 529, 530, 531, 550, 558, 561, 562, 563, 566, 568, 569, 575, 576, 577, 581, 583, 598, 604, 607, 608, 609, 613, 617, 624, 626, 627,
628, 629, 630, 632, 633, 643, 645, 649, 650, 658, 664, 665, 669, 670, 671, 672, 676, 686, 690, 695, 696, 697, 698, 699, 700, 701, 702, 706, 707, 709, 712, 714, 718, 720, 725, 727, 728, 733, 748, 752, 753, 758, 760, 761, 762, 767, 769, 772, 773, 774, 779, 784, 786, 788, 789, 793, 795, 797, 798, 799, 802, 803, 804, 809, 814, 818, 833], array([1.        , 0.27678571, 1.        , 0.52564103, 0.83333333,
       0.6       , 0.40816327, 0.54782609, 0.52380952, 0.75      ,
       0.58333333, 0.3907563 , 0.74603175, 0.56145833, 0.6875    ,
       0.59747024, 1.        , 0.66666667, 0.57777778, 0.51578947,
       0.53194444, 0.        , 0.56666667, 1.        , 0.        ,
       0.49368687, 0.30952381, 0.66666667, 0.6875    , 0.06666667,
       0.90277778, 0.58333333, 0.        , 0.703125  , 0.5       ,
       0.66060026, 0.57539683, 0.49216028, 0.82638889, 1.        ,
       0.625     , 0.        , 0.51576923, 0.5       , 0.5       ,
       0.25      , 0.        , 0.57638889, 0.5       , 0.5       ,
       1.        , 0.73214286, 0.41666667, 0.62037037, 0.65      ,
       0.5       , 0.625     , 0.17857143, 0.75      , 0.36479592,
       0.78571429, 0.7       , 0.68916667, 0.65838509, 0.48214286,
       0.        , 0.5       , 0.66666667, 0.5       , 0.34130435,
       0.58333333, 1.        , 0.        , 0.42502787, 0.57058824,
       0.5       , 0.78075397, 0.61315789, 0.64409938, 0.1875    ,
       0.94444444, 0.49259259, 0.5       , 0.44223986, 0.77083333,
       0.58660131, 0.51432292, 0.41666667, 0.28070175, 0.82352941,
       0.57983193, 0.36507937, 0.7       , 1.        , 0.        ,
       0.52083333, 1.        , 0.6       , 0.        , 0.5       ,
       0.84722222, 0.5       , 0.61904762, 0.        , 0.5       ,
       0.51633987, 0.5078125 , 0.33333333, 0.35      , 0.        ,
       0.7       , 0.77777778, 0.        , 0.48387097, 0.73333333,
       0.5       , 0.45833333, 0.33333333, 0.        , 0.66666667,
       0.49234099, 0.42857143, 0.62156863, 0.        , 0.60175439,
       0.32142857, 0.83333333, 0.83333333, 0.55742297, 0.35869565,
       0.        , 0.4375    , 0.33333333, 0.6       , 0.38888889,
       0.5       , 0.        , 0.5       , 0.61578947, 0.        ,
       0.57142857, 0.        , 0.625     , 0.46701389, 0.        ,
       0.36734694, 0.9       , 0.44444444, 0.5855615 , 0.33333333,
       0.43055556, 1.        , 0.75      , 0.34444444, 1.        ,
       0.45726496, 0.47190476, 0.3125    , 0.16666667, 0.33333333,
       0.5       , 0.29166667, 0.5       , 0.        , 0.68431373,
       0.4981685 , 0.48214286, 0.4702381 , 0.22222222, 0.63333333,
       0.55147059, 0.53535354, 0.77777778, 0.47513568, 0.47272727,
       0.55555556, 0.25      , 0.51312192, 0.5       , 1.        ,
       1.        , 0.33333333, 1.        , 0.64444444, 0.59090909,
       0.5       , 0.23611111, 0.        , 0.5       , 0.72      ,
       0.        , 0.5       , 0.72727273, 1.        , 0.608     ,
       0.66666667, 0.66666667, 1.        , 0.77777778, 0.5326087 ,
       0.24      , 0.52046784, 0.48655462, 0.28571429, 0.35294118,
       0.45833333, 0.61111111, 0.75      , 0.33333333, 0.26923077,
       0.        , 1.        , 0.4       , 0.28125   , 0.75      ,
       0.        , 0.58571429, 0.        , 1.        , 1.        ,
       0.51538462, 0.45918367, 0.66666667, 0.525     , 1.        ,
       0.33333333, 0.33333333, 0.42857143, 1.        , 0.57692308,
       0.63888889, 0.66666667, 0.59672184, 0.66666667, 0.50757576,
       0.93333333, 0.75630252, 0.2       , 0.57954545]))
rank_0 auc: 0.5225780021408466
2025-10-27 14:59:27,942 [INFO] Training time 0:49:47

重跑，此为tallrec结果，可知，模型一致提示词不一致，则评估结果不一致

2025-10-27 20:29:08,893 [INFO] Averaged stats: loss: 6.878286  acc: 0.530297 ***auc: 0.5202658047054376 ***uauc:(0.5401093157615947, [20, 26, 33, 36, 37, 39, 40, 41, 49, 57, 72, 73, 79, 83, 85, 87, 93, 95, 104, 107, 108, 109, 110, 112, 119, 121
, 124, 139, 142, 145, 147, 149, 153, 155, 159, 164, 165, 170, 171, 173, 174, 175, 177, 178, 180, 185, 186, 193, 197, 200, 204, 205, 207, 208, 210, 212, 214, 215, 221, 222, 226, 227, 228, 230, 231, 237, 242, 246, 247, 249, 250, 255, 260, 261, 26
4, 271, 273, 275, 277, 279, 282, 286, 291, 292, 296, 297, 298, 300, 304, 308, 309, 312, 314, 325, 327, 329, 336, 338, 340, 341, 345, 346, 350, 353, 356, 364, 367, 368, 370, 377, 381, 382, 384, 389, 402, 415, 426, 427, 428, 433, 434, 436, 441, 4
44, 446, 449, 451, 453, 458, 462, 466, 470, 472, 474, 475, 482, 484, 490, 494, 496, 498, 500, 512, 516, 521, 522, 529, 530, 531, 550, 558, 561, 562, 563, 566, 568, 569, 575, 576, 577, 581, 583, 598, 604, 607, 608, 609, 613, 617, 624, 626, 627,
628, 629, 630, 632, 633, 643, 645, 649, 650, 658, 664, 665, 669, 670, 671, 672, 676, 686, 690, 695, 696, 697, 698, 699, 700, 701, 702, 706, 707, 709, 712, 714, 718, 720, 725, 727, 728, 733, 748, 752, 753, 758, 760, 761, 762, 767, 769, 772, 773, 774, 779, 784, 786, 788, 789, 793, 795, 797, 798, 799, 802, 803, 804, 809, 814, 818, 833], array([1.        , 0.46428571, 1.        , 0.61217949, 1.        ,
       0.        , 0.51020408, 0.56521739, 0.82142857, 0.375     ,
       0.5625    , 0.31722689, 0.55555556, 0.60017361, 0.25      ,
       0.69717262, 0.66666667, 0.41666667, 0.6       , 0.70526316,
       0.54444444, 0.        , 0.36666667, 1.        , 0.5       ,
       0.60921717, 0.30952381, 0.8       , 0.3125    , 0.26666667,
       0.54166667, 0.83333333, 0.        , 0.71875   , 0.5       ,
       0.51149425, 0.75      , 0.45644599, 0.65277778, 1.        ,
       0.75      , 0.33333333, 0.43461538, 0.5       , 0.4       ,
       0.25      , 1.        , 0.53125   , 0.        , 0.25      ,
       1.        , 0.68154762, 0.66666667, 0.48765432, 0.9       ,
       0.66666667, 0.75      , 0.23214286, 0.69444444, 0.26530612,
       0.75      , 0.7       , 0.59666667, 0.54192547, 0.56181319,
       0.5       , 0.25      , 0.33333333, 0.5       , 0.33695652,
       0.34848485, 0.66666667, 0.        , 0.61426979, 0.49117647,
       0.1875    , 0.625     , 0.53684211, 0.53074534, 0.08333333,
       0.55555556, 0.90555556, 0.78571429, 0.30202822, 0.67013889,
       0.54411765, 0.5078125 , 0.55392157, 0.51315789, 0.84705882,
       0.46218487, 0.74603175, 0.7       , 0.625     , 0.5       ,
       0.39583333, 1.        , 0.1       , 0.33333333, 0.25      ,
       0.77777778, 0.5       , 0.52380952, 0.66666667, 0.75      ,
       0.53649237, 0.359375  , 0.5       , 0.3       , 0.        ,
       0.36      , 0.87962963, 0.33333333, 0.50509338, 0.46666667,
       0.        , 0.66666667, 0.33333333, 1.        , 0.6       ,
       0.42873793, 0.52380952, 0.55980392, 0.        , 0.65087719,
       0.76785714, 0.66666667, 0.16666667, 0.57819795, 0.44565217,
       1.        , 0.39583333, 0.66666667, 0.8       , 0.63541667,
       1.        , 0.5       , 0.        , 0.84210526, 0.        ,
       0.14285714, 0.        , 0.625     , 0.63020833, 0.5       ,
       0.48979592, 0.8       , 0.44444444, 0.40374332, 0.33333333,
       0.59722222, 1.        , 0.5       , 0.26666667, 0.        ,
       0.52564103, 0.42      , 0.5625    , 0.33333333, 0.        ,
       1.        , 0.33333333, 0.875     , 0.        , 0.60784314,
       0.48290598, 0.73214286, 0.35714286, 0.33333333, 0.56666667,
       0.625     , 0.56060606, 0.72222222, 0.49091253, 0.16363636,
       0.59259259, 0.75      , 0.52515036, 0.5       , 0.375     ,
       1.        , 0.83333333, 1.        , 0.75555556, 0.64772727,
       1.        , 0.43055556, 0.25      , 0.85      , 0.72      ,
       1.        , 0.5       , 0.63636364, 1.        , 0.554     ,
       0.        , 0.33333333, 0.33333333, 0.77777778, 0.51283213,
       0.36      , 0.47807018, 0.60462185, 0.46428571, 0.80882353,
       0.83333333, 0.66666667, 1.        , 1.        , 0.28846154,
       0.5       , 1.        , 0.33333333, 0.75      , 0.25      ,
       1.        , 0.5       , 0.        , 0.        , 0.        ,
       0.38846154, 0.66326531, 0.66666667, 0.325     , 1.        ,
       0.47222222, 0.66666667, 1.        , 0.        , 0.78205128,
       0.65277778, 0.5       , 0.48717949, 1.        , 0.46969697,
       0.8       , 0.80672269, 0.23333333, 0.70549242]))
rank_0 auc: 0.5202658047054376
2025-10-27 20:29:08,893 [INFO] Training time 0:20:30
